<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>ë©”ì¸ í˜ì´ì§€</title>
</head>
<body>
    <h2>í™˜ì˜í•©ë‹ˆë‹¤! ğŸ‰</h2>
    <p id="user-info">ë¡œê·¸ì¸ ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</p>
    <button id="logout">ë¡œê·¸ì•„ì›ƒ</button>

    <script>
        // JWT í† í° ê°€ì ¸ì˜¤ê¸° (ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ì—ì„œ)
        const token = localStorage.getItem("jwtToken");

        if (!token) {
            window.location.href = "/login.html"; // ë¡œê·¸ì¸ ì•ˆ ë˜ì–´ ìˆìœ¼ë©´ ë¡œê·¸ì¸ í˜ì´ì§€ë¡œ ì´ë™
        } else {
            fetch("http://localhost:8080/api/users/me", {
                method: "GET",
                headers: { "Authorization": `Bearer ${token}` }
            })
            .then(response => response.json())
            .then(data => {
                document.getElementById("user-info").textContent = `ì•ˆë…•í•˜ì„¸ìš”, ${data.username}ë‹˜!`;
            })
            .catch(error => {
                console.error("ì‚¬ìš©ì ì •ë³´ ë¡œë“œ ì‹¤íŒ¨:", error);
                localStorage.removeItem("jwtToken");
                window.location.href = "/login.html"; // í† í° ì˜¤ë¥˜ ì‹œ ë¡œê·¸ì¸ í˜ì´ì§€ë¡œ ì´ë™
            });
        }

        // ë¡œê·¸ì•„ì›ƒ ë²„íŠ¼ í´ë¦­ ì‹œ JWT ì‚­ì œ í›„ ë¡œê·¸ì¸ í˜ì´ì§€ë¡œ ì´ë™
        document.getElementById("logout").addEventListener("click", function() {
            localStorage.removeItem("jwtToken");
            window.location.href = "/login.html";
        });
    </script>
</body>
</html>
